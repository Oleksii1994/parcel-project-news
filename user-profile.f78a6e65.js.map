{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,uCAmBA,MAWMC,GAAM,EAAAC,EAAAC,eAXW,CACrBC,OAAQ,0CACRC,WAAY,sCACZC,YAAa,0DACbC,UAAW,sBACXC,cAAe,kCACfC,kBAAmB,eACnBC,MAAO,4CACPC,cAAe,iBAIXC,GAAW,EAAAC,EAAAC,aAAYb,GACvBc,GAAO,EAAAC,EAAAC,WAGN,MAAMC,GAAW,EAAAL,EAAAM,KAAIP,EAAU,SAEhCQ,EAAO,CACXC,SAAUC,SAASC,cAAc,sBACjCC,UAAWF,SAASC,cAAc,uBAClCE,gBAAiBH,SAASC,cAAc,oBACxCG,kBAAmBJ,SAASC,cAAc,yBAC1CI,aAAcL,SAASC,cAAc,yBACrCK,SAAUN,SAASC,cAAc,sBAGnCH,EAAKK,gBAAgBI,iBAAiB,UA8BtC,SAA4BC,GAC1BA,EAAEC,iBACF,MAAMC,EAAQF,EAAEG,OAAOC,SAAS,GAAGC,MACnCC,QAAQC,IAAIL,GAC+B,iBAAvCZ,EAAKM,kBAAkBY,cACzB,EAAAzB,EAAA0B,KAAIrB,GACDsB,MAAKC,IACJA,EAASC,SAAQC,IACf,MAAMC,EAAO7B,EAAK8B,YAIZC,EAAUH,EAAcI,MAC1BD,EAAQE,QAAUJ,EAAKI,QAErBhB,IAAUc,EAAQG,UACpBC,EAAAnD,GAASoD,OAAOC,QAAQ,mBACxBhC,EAAKM,kBAAkB2B,UAAY,gBAEnCH,EAAAnD,GAASoD,OAAOG,QAAQ,oC,GAG5B,IAEHC,OAAMC,IACLN,EAAAnD,GAASoD,OAAOG,QAAQ,0CACxBlB,QAAQoB,MAAMA,EAAM,IAGiB,iBAAvCpC,EAAKM,kBAAkBY,cACzB,EAAAzB,EAAA0B,KAAIrB,GACDsB,MAAKC,IACJA,EAASC,SAAQC,IACf,MAAMC,EAAO7B,EAAK8B,YAElB,GADgBF,EAAcI,MAClBC,QAAUJ,EAAKI,MAIzB,OAHA5B,EAAKM,kBAAkB2B,UAAY,eAEnCH,EAAAnD,GAASoD,OAAOC,QAAQ,kCACjB,EAAAvC,EAAA4C,SAAO,EAAA5C,EAAAM,KAAIP,EAAU,SAASgC,EAAKc,OAAQ,CAChDT,SAAUjB,G,GAGd,IAEHuB,OAAMC,IACLN,EAAAnD,GAASoD,OAAOG,QAAQ,0CACxBlB,QAAQoB,MAAMA,EAAM,G,KAxE1B,EAAA3C,EAAA0B,KAAIrB,GACDsB,MAAKC,IACJA,EAASC,SAAQC,IACf,MAAMC,EAAO7B,EAAK8B,YACZC,EAAUH,EAAcI,MAC1BD,EAAQE,MAAUJ,EAAKI,MAI3B,MAAMW,EAAgBb,EAAQc,kBAAkBC,QAC9CC,GAAiB,KAATA,IAEJC,EAAWjB,EAAQkB,aAAaH,QAAOC,GAAiB,KAATA,IAErD1C,EAAKC,SAASgC,UAAYP,EAAQmB,SAClC7C,EAAKI,UAAU6B,UAAYP,EAAQE,MACnC5B,EAAKO,aAAa0B,UAAYM,EAAcO,OAC5C9C,EAAKQ,SAASyB,UAAYU,EAASG,MAAM,GACzC,IAEHX,OAAMC,IACLpB,QAAQoB,MAAMA,EAAM","sources":["src/js/firebace/user-profile.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport { initializeApp, firebase } from 'firebase/app';\nimport {\n  getDatabase,\n  set,\n  ref,\n  update,\n  get,\n  child,\n  userId,\n} from 'firebase/database';\nimport {\n  getAuth,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  onAuthStateChanged,\n  signOut,\n} from 'firebase/auth';\n\nconst firebaseConfig = {\n  apiKey: 'AIzaSyDD_Eh4tyvM30ivpTHWqfHo7r2h0gDev4Y',\n  authDomain: 'project-goit2023-js.firebaseapp.com',\n  databaseURL: 'https://project-goit2023-js-default-rtdb.firebaseio.com',\n  projectId: 'project-goit2023-js',\n  storageBucket: 'project-goit2023-js.appspot.com',\n  messagingSenderId: '407142734195',\n  appId: '1:407142734195:web:6d45ec3cdde16415370d06',\n  measurementId: 'G-VMY0EQ75TG',\n};\n\nconst app = initializeApp(firebaseConfig);\nconst database = getDatabase(app);\nconst auth = getAuth();\nexport let LOCALSTORAGE_USER = '';\n\nexport const usersRef = ref(database, 'users');\n\nconst refs = {\n  userName: document.querySelector('.user-profile-name'),\n  userEmail: document.querySelector('.user-profile-email'),\n  chancgePassword: document.querySelector('.change-password'),\n  changePasswordPrg: document.querySelector('.change-password--prg'),\n  favoriteNews: document.querySelector('.favorite-news-render'),\n  readNews: document.querySelector('.read-news-render'),\n};\n\nrefs.chancgePassword.addEventListener('submit', changeUserPassword);\n\ngetNameAndEmail();\n\nfunction getNameAndEmail() {\n  get(usersRef)\n    .then(snapshot => {\n      snapshot.forEach(childSnapshot => {\n        const user = auth.currentUser;\n        const userArr = childSnapshot.val();\n        if (userArr.email === user.email) {\n          //   console.log(userArr);\n        }\n\n        const newsFavourite = userArr.newsFavouriteData.filter(\n          item => item !== ''\n        );\n        const newsRead = userArr.newsReadData.filter(item => item !== '');\n\n        refs.userName.innerHTML = userArr.username;\n        refs.userEmail.innerHTML = userArr.email;\n        refs.favoriteNews.innerHTML = newsFavourite.length;\n        refs.readNews.innerHTML = newsRead.length;\n      });\n    })\n    .catch(error => {\n      console.error(error);\n    });\n}\n\nfunction changeUserPassword(e) {\n  e.preventDefault();\n  const input = e.target.children[1].value;\n  console.log(input);\n  if (refs.changePasswordPrg.textContent === 'old password') {\n    get(usersRef)\n      .then(snapshot => {\n        snapshot.forEach(childSnapshot => {\n          const user = auth.currentUser;\n\n          // console.log(user.uid);\n\n          const userArr = childSnapshot.val();\n          if (userArr.email === user.email) {\n            // console.log(userArr.password);\n            if (input === userArr.password) {\n              Notiflix.Notify.success('Corect Password');\n              refs.changePasswordPrg.innerHTML = 'new password';\n            } else {\n              Notiflix.Notify.failure('Wrong password, please try again');\n            }\n          }\n        });\n      })\n      .catch(error => {\n        Notiflix.Notify.failure('Something went wrong, please try again');\n        console.error(error);\n      });\n  }\n  if (refs.changePasswordPrg.textContent === 'new password') {\n    get(usersRef)\n      .then(snapshot => {\n        snapshot.forEach(childSnapshot => {\n          const user = auth.currentUser;\n          const userArr = childSnapshot.val();\n          if (userArr.email === user.email) {\n            refs.changePasswordPrg.innerHTML = 'old password';\n            // console.log(userArr.password);\n            Notiflix.Notify.success('Password changed successfully');\n            return update(ref(database, `users/${user.uid}`), {\n              password: input,\n            });\n          }\n        });\n      })\n      .catch(error => {\n        Notiflix.Notify.failure('Something went wrong, please try again');\n        console.error(error);\n      });\n  }\n}\n"],"names":["$7Y9D8","parcelRequire","$36677938ff91c2ca$var$app","$gKkQl","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","$36677938ff91c2ca$var$database","$jAzyG","getDatabase","$36677938ff91c2ca$var$auth","$eyjy7","getAuth","$36677938ff91c2ca$export$614862d7a42f7add","ref","$36677938ff91c2ca$var$refs","userName","document","querySelector","userEmail","chancgePassword","changePasswordPrg","favoriteNews","readNews","addEventListener","e","preventDefault","input","target","children","value","console","log","textContent","get","then","snapshot","forEach","childSnapshot","user","currentUser","userArr","val","email","password","$parcel$interopDefault","Notify","success","innerHTML","failure","catch","error","update","uid","newsFavourite","newsFavouriteData","filter","item","newsRead","newsReadData","username","length"],"version":3,"file":"user-profile.f78a6e65.js.map"}